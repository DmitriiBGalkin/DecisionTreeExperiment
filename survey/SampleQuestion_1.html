{{ block style }}
    <link rel="stylesheet" type="text/css" href="{{ static 'survey/global_style.css' }}">
 <style>
 .slider-wrapper {
    position: relative; /* Important: make slider-wrapper the positioning parent */
}
.error-message {
    margin-top: 8px; /* space from the slider */
    background: #ffffff;
    color: #d9534f; /* red color for errors */
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1.1em;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    white-space: normal;
    text-align: center;
    display: block;
}

.error-message:empty {
    display: none;
}



</style>


{{ endblock }}


{{ block scripts }}
<script>
window.addEventListener('DOMContentLoaded', function() {
    const dummySlider = document.getElementById('dummy_slider');
    const realSlider = document.getElementById('confidence_slider');
    const sliderValue = document.getElementById('sliderValue');
    const sliderWrapper = document.querySelector('.slider-wrapper');
    const errorMessage = document.querySelector('.error-message');

    let isDragging = false;
    let hasInteracted = false; // üî• new flag to control initial visibility

    // Initially hide dummy slider and value
    dummySlider.style.visibility = 'hidden';
    sliderValue.innerText = '';
    sliderValue.style.visibility = 'hidden';

    function updateSliderFromEvent(e) {
        const rect = sliderWrapper.getBoundingClientRect();
        const clickPos = (e.clientX - rect.left) / rect.width * 100;
        const clampedPos = Math.max(0, Math.min(100, clickPos));

        dummySlider.value = Math.round(clampedPos);
        realSlider.value = dummySlider.value;
        sliderValue.innerText = dummySlider.value;

        // Only after first user interaction, show the slider + value
        if (!hasInteracted) {
            dummySlider.style.visibility = 'visible';
            sliderValue.style.visibility = 'visible';
            hasInteracted = true;
        }

        if (errorMessage) {
            errorMessage.style.display = 'none';
        }
    }

    sliderWrapper.addEventListener('mousedown', function(e) {
        isDragging = true;
        updateSliderFromEvent(e);
    });

    window.addEventListener('mousemove', function(e) {
        if (isDragging) {
            updateSliderFromEvent(e);
        }
    });

    window.addEventListener('mouseup', function() {
        isDragging = false;
    });

    dummySlider.addEventListener('input', function() {
        realSlider.value = this.value;
        sliderValue.innerText = this.value;

        if (!hasInteracted) {
            dummySlider.style.visibility = 'visible';
            sliderValue.style.visibility = 'visible';
            hasInteracted = true;
        }

        if (errorMessage) {
            errorMessage.style.display = 'none';
        }
    });
});
</script>


{{ endblock }}


{{ block content }}

<!-- Instruction Box -->
<div class="box">
    <h4>{% if en %}Sample Question 1 {% else %}Beispielaufgabe 1{% endif %}</h4>

    <b>{% if en %}Instructions{% else %}Anweisungen{% endif %}:</b>
    <p>
        {% if en %}
            In this experiment, you will assume the role of a <b>loan applicant</b> with a fixed profile.
            You can find this information on the <b>right side</b> of the screen ‚Äì this information will remain <b>unchanged</b> throughout the experiment.
        {% else %}
            In diesem Experiment √ºbernehmen Sie die Rolle eines <b>Kreditantragstellers</b> mit einem festen Profil.
            Diese Informationen finden Sie auf der <b>rechten Seite</b> des Bildschirms ‚Äì sie bleiben <b>w√§hrend des gesamten Experiments unver√§ndert</b>.
        {% endif %}
    </p>

    <p>
        {% if en %}
            You will be presented with multiple <b>decision trees</b>, each representing a different loan approval process used by banks.
            Your task is to determine whether your loan application would be <b>approved or denied</b> based on the decision tree and your profile information.
        {% else %}
            Ihnen werden mehrere <b>Entscheidungsb√§ume</b> pr√§sentiert, die jeweils einen anderen Kreditgenehmigungsprozess von Banken darstellen.
            Ihre Aufgabe ist es zu bestimmen, ob Ihr Kreditantrag basierend auf dem Entscheidungsbaum und Ihren Profilinformationen
            <b>genehmigt oder abgelehnt</b> wird.
        {% endif %}
    </p>

    <p>
        {% if en %}
            After making your decision, you will also be asked to indicate <b>how confident</b> you are in your answer.
        {% else %}
            Nachdem Sie Ihre Entscheidung getroffen haben, werden Sie au√üerdem gebeten, anzugeben, <b>wie sicher</b> Sie sich Ihrer Antwort sind.
        {% endif %}
    </p>

    <p>
        {% if en %}
            Below is an example question and explanation.
        {% else %}
            Unten finden Sie eine Beispielaufgabe und eine Erl√§uterung.
        {% endif %}

    </p>
</div>


<!-- Two-column layout -->
<div class="container-flex">
    <!-- Left Side (Decision Tree) -->
    <div class="left-container">
            {{ include svg_template }}
    </div>

<!-- Profile Information Section -->
<div class="right-container">
    {{ include 'survey/Table_Profile_Information.html'}}
</div>

</div>

<!-- Questions Section -->
<div class="form-container">
        {{ formfield 'question_loan_sample1' }}
  <div style="margin: 5px auto; padding: 5px; max-width: 800px; background-color: #eaf7ff; border: 1px solid #b3e0ff; border-radius: 5px; text-align: left;">
        {% if en %}
            <strong>Explanation:</strong> According to the profile information, the loan amount is <strong>20.000 ‚Ç¨</strong>, which is higher than 5.000 ‚Ç¨. Therefore, the decision tree would branch to the right. It is then evaluated based on income, which is <strong>45.000 ‚Ç¨</strong> (below the required 100.000 ‚Ç¨). Therefore, the correct answer to this question is that the loan would be <strong>denied</strong>.
        {% else %}
            <strong>Erl√§uterung:</strong> Laut den Profilinformationen betr√§gt die Kreditsumme <strong>20.000 ‚Ç¨</strong>, was h√∂her als 5.000 ‚Ç¨ ist. Daher w√ºrde der Entscheidungsbaum nach rechts abzweigen. Danach erfolgt eine Bewertung basierend auf dem Einkommen, welches <strong>45.000 ‚Ç¨</strong> betr√§gt (unter 100.000 ‚Ç¨). Daher lautet die korrekte Antwort auf diese Frage, dass der Kredit <strong>abgelehnt</strong> w√ºrde.
        {% endif %}
    </div>
</div>




<div class="form-container">
    {{ Lexicon.confidence_level_label }}
  <div class="slider-container">
      <div class="slider-ticks-top">
    <span class="tick-label left">0</span>
    <span class="tick-label right">100</span>
  </div>
    <div class="slider-wrapper">
      <!-- Background track -->
      <div class="slider-track"></div>

      <!-- Dummy input for user interaction -->
      <input
        type="range"
        id="dummy_slider"
        min="0"
        max="100"
        step="1"
        value="" required>  <!-- or blank if you prefer -->


      <!-- Real hidden input for oTree submission -->
      <input
        type="hidden"
        id="confidence_slider"
        name="confidence_level_sample1"
      >
    </div>
    <div class="value-display">
      {{ Lexicon.value_label_prefix }} <span id="sliderValue"></span> {{ Lexicon.value_label_suffix }}
        <div class="error-message">{{ formfield_errors 'confidence_level_sample1' }}</div>
    </div>

  </div>
        <div style="margin: 5px auto; padding: 5px; max-width: 800px; background-color: #eaf7ff; border: 1px solid #b3e0ff; border-radius: 5px; text-align: left;">
        {{ if en }}
            <strong>Explanation:</strong> First, to activate the slider, please click anywhere on the slider ‚Äî then the thumb will appear. You can then drag or click the desired position to indicate how sure you are in your answer. For this sample question, please select any value above 90 to show a high degree of confidence (for example, 100).
        {{ else }}
            <strong>Erl√§uterung:</strong> Um den Schieberegler zu aktivieren, klicken Sie bitte zun√§chst irgendwo auf den Schieberegler ‚Äì dann erscheint der Reglerknopf. Sie k√∂nnen dann die gew√ºnschte Position anklicken oder ziehen, um anzugeben, wie sicher Sie sich bei Ihrer Antwort sind. F√ºr diese Beispielaufgabe w√§hlen Sie bitte einen Wert √ºber 90, um ein hohes Ma√ü an Sicherheit anzuzeigen (zum Beispiel 100).
        {{ endif }}
    </div>
</div>

  <div class="btn-container">
    {{ next_button }}
  </div>

{{ include_sibling 'student_feedback.html' with feedback_field='SampleQuestion_1_SF' }}


{{ endblock }}

